# 文丰AI 项目部署与 NotebookLM PDF 生成 - 需求文档

## 1. 背景
当前项目位于 `wenfengai-main`，包含前端（Vite + React）与后端（FastAPI）。后端已集成 `notebooklm-py` 生成 Slide Deck 并下载 PDF。目标是把整个项目部署到 Zeabur，并用 GitHub 仓库 `https://github.com/Kingsley188/wenfengai` 进行项目管理与持续部署。

## 2. 目标
1. 将项目初始化为 Git 仓库并推送到 `Kingsley188/wenfengai`。
2. 在 Zeabur 上完成前后端部署，形成可访问的线上环境。
3. 通过后端调用 `notebooklm-py`，实现“上传资料 → 生成 Slide Deck → 输出 PDF”。
4. 确保前端可访问后端生成结果并展示/下载 PDF。

## 3. 现状概览
- 前端：Vite + React，入口路由在 `src/App.tsx`。
- 后端：`backend/`，FastAPI，核心接口：
  - `POST /api/generate-slides` 上传文件生成 PDF
  - `GET /api/status/{task_id}` 查询生成状态
  - `GET /api/health` 健康检查
- NotebookLM：后端通过 `notebooklm-py` 生成 Slide Deck PDF。
- 环境变量（前端已使用）：
  - `VITE_BACKEND_URL`：后端 API 基地址
  - `VITE_SUPABASE_URL`、`VITE_SUPABASE_PUBLISHABLE_KEY`
- NotebookLM 认证：
  - 需提供 `NOTEBOOKLM_AUTH_JSON` 或 `storage_state.json`（参考 `notebooklm-py` 配置文档）

## 4. 范围与边界
### 范围内
- Git 初始化、`.gitignore` 配置、推送到指定 GitHub 仓库
- Zeabur 上的前端与后端部署
- NotebookLM PDF 生成通路打通（上传 → 生成 → 下载）
- 前端与后端的 URL 对接与环境变量配置

### 范围外
- 公众号文章发布流程
- NotebookLM 功能的深度定制（仅实现 PDF 生成）
- 复杂队列、分布式任务系统（当前仅内存任务状态）

## 5. 功能需求
### FR-01 仓库管理
- 初始化 Git 仓库并推送至 `https://github.com/Kingsley188/wenfengai`
- `.gitignore` 排除 `node_modules/`、`npm-cache/`、Python 虚拟环境等

### FR-02 前端部署
- 产物：Vite 静态构建（`npm run build`）
- 运行环境变量：`VITE_BACKEND_URL`、`VITE_SUPABASE_URL`、`VITE_SUPABASE_PUBLISHABLE_KEY`
- 前端通过 `VITE_BACKEND_URL` 调用后端 API

### FR-03 后端部署
- FastAPI 运行入口：`uvicorn main:app --host 0.0.0.0 --port $PORT`
- `notebooklm-py` 依赖安装（`backend/requirements.txt`）
- NotebookLM 认证：
  - 方案 A：设置 `NOTEBOOKLM_AUTH_JSON`
  - 方案 B：上传 `storage_state.json` 并设置 `NOTEBOOKLM_HOME`

### FR-04 PDF 生成流程
- 用户上传文件后，后端生成 Slide Deck 并返回 PDF URL
- 前端轮询 `/api/status/{task_id}` 并展示结果
- 生成文件需具备公网访问能力（临时可用后端静态目录，后续可接 Supabase Storage）

## 6. 非功能需求
- 可用性：后端故障需明确返回错误信息
- 安全性：NotebookLM 认证信息不可硬编码进仓库
- 可维护性：部署流程可重复，环境变量集中管理
- 合规：国内服务器需考虑备案与域名绑定规则

## 7. 部署策略（初版）
- Zeabur 创建两个服务：
  - 前端服务：绑定 GitHub 仓库，运行 `npm run build` + 静态部署
  - 后端服务：运行 FastAPI 服务（Python）
- 前端 `VITE_BACKEND_URL` 指向后端服务域名

## 8. 里程碑
1. Git 初始化并推送到 `Kingsley188/wenfengai`
2. Zeabur 前端部署成功（可访问 Landing）
3. Zeabur 后端部署成功（`/api/health` 正常）
4. 端到端验证：上传资料 → 生成 PDF → 前端展示

## 9. 待确认
1. 是否确认将整个项目推送到 `Kingsley188/wenfengai`？
2. Zeabur 使用的是自有服务器还是共享集群？
3. 后端生成 PDF 结果是否需要长期存储（Supabase）？
4. NotebookLM 认证采用 `NOTEBOOKLM_AUTH_JSON` 还是 `storage_state.json`？
